<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة الدواجن الاحترافي</title>
    <style>
        :root { --main: #2e7d32; --accent: #ffa000; --bg: #f8f9fa; --text: #333; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; color: var(--text); }
        
        /* شاشة الدخول */
        .login-screen { display: flex; justify-content: center; align-items: center; height: 100vh; background: #2e7d32; }
        .login-card { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); width: 100%; max-width: 350px; text-align: center; }
        
        /* لوحة التحكم */
        #dashboard { display: none; }
        header { background: white; padding: 15px 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-bottom: 3px solid var(--main); }
        .container { padding: 30px 5%; max-width: 1200px; margin: auto; }
        
        /* البطاقات والجداول */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .form-card { border-top: 5px solid var(--accent); }
        
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        button { width: 100%; padding: 12px; background: var(--main); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { opacity: 0.9; }
        
        table { width: 100%; background: white; border-collapse: collapse; margin-top: 20px; border-radius: 10px; overflow: hidden; }
        th, td { padding: 15px; text-align: right; border-bottom: 1px solid #eee; }
        th { background: #f1f1f1; color: var(--main); }
        
        .badge { padding: 5px 10px; border-radius: 20px; font-size: 12px; background: #e8f5e9; color: #2e7d32; }
    </style>
</head>
<body>

    <div id="loginPage" class="login-screen">
        <div class="login-card">
            <h1 style="color: var(--main); margin-bottom: 10px;">POULTRY SYSTEM</h1>
            <p style="color: #666;">إدارة مشاريع الدواجن الذكية</p>
            <input type="text" id="username" placeholder="اسم المستخدم">
            <input type="password" id="password" placeholder="كلمة المرور">
            <button onclick="handleLogin()">دخول النظام</button>
        </div>
    </div>

    <div id="dashboard">
        <header>
            <h2 style="color: var(--main); margin:0;">لوحة التحكم الرئيسية</h2>
            <button onclick="location.reload()" style="width: auto; background: #d32f2f; padding: 8px 20px;">خروج</button>
        </header>

        <div class="container">
            <div class="grid">
                <div class="card" style="border-right: 5px solid #2e7d32;">
                    <small>إجمالي عدد الطيور</small>
                    <h2 id="totalBirdsDisplay">12,500</h2>
                </div>
                <div class="card" style="border-right: 5px solid #ffa000;">
                    <small>إنتاج اليوم (طبق)</small>
                    <h2>450</h2>
                </div>
            </div>

            <div class="grid">
                <div class="card form-card">
                    <h3>إدخال بيانات يومية</h3>
                    <p style="font-size: 12px; color: #777;">سيتم حفظ هذه البيانات تلقائياً في ملف الإكسل</p>
                    <input type="text" id="barnId" placeholder="رقم أو اسم العنبر">
                    <input type="number" id="birdsCount" placeholder="عدد الطيور الحالي">
                    <input type="number" id="eggsCount" placeholder="كمية الإنتاج">
                    <button onclick="sendDataToSheets()" id="saveBtn">حفظ في قاعدة البيانات</button>
                </div>

                <div class="card" style="grid-column: span 1;">
                    <h3>حالة العنابر الحالية</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>العنبر</th>
                                <th>الحالة</th>
                                <th>الإنتاج</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>عنبر 1</td>
                                <td><span class="badge">مستقر</span></td>
                                <td>85%</td>
                            </tr>
                            <tr>
                                <td>عنبر 2</td>
                                <td><span class="badge">مستقر</span></td>
                                <td>90%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // دالة تسجيل الدخول
        function handleLogin() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u === "admin" && p === "123") {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
            } else {
                alert("بيانات الدخول خاطئة!");
            }
        }

        // دالة إرسال البيانات لجوجل شيت
        function sendDataToSheets() {
            const btn = document.getElementById('saveBtn');
            const data = {
                barn: document.getElementById('barnId').value,
                count: document.getElementById('birdsCount').value,
                eggs: document.getElementById('eggsCount').value
            };

            if(!data.barn || !data.count) {
                alert("يرجى ملء البيانات الأساسية");
                return;
            }

            btn.innerText = "جاري الحفظ...";
            btn.disabled = true;

            // ضع هنا الرابط (URL) الذي حصلت عليه من Google Apps Script
            const scriptURL = 'ضع_رابط_جوجل_هنا';

            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors', // لتجنب مشاكل الحماية أثناء التجربة
                cache: 'no-cache',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(() => {
                alert("تم إرسال البيانات بنجاح إلى الإكسل!");
                btn.innerText = "حفظ في قاعدة البيانات";
                btn.disabled = false;
                // تصفير الخانات
                document.getElementById('barnId').value = "";
                document.getElementById('birdsCount').value = "";
                document.getElementById('eggsCount').value = "";
            }).catch(err => {
                alert("خطأ في الاتصال");
                btn.disabled = false;
            });
        }
    </script>
</body>
</html>
