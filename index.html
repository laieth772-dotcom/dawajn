<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>النظام الملكي لإدارة المزارع</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #1b5e20;
            --secondary: #2e7d32;
            --accent: #ffa000;
            --danger: #d32f2f;
            --bg: #f0f2f5;
            --white: #ffffff;
        }

        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; color: #333; }

        /* شريط التنقل العلوي */
        nav {
            background: var(--primary);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-links { display: flex; gap: 20px; }
        .nav-links span { cursor: pointer; font-weight: 500; transition: 0.3s; display: flex; align-items: center; gap: 5px; }
        .nav-links span:hover { color: var(--accent); }

        /* الصفحات */
        .page { display: none; padding: 25px; max-width: 1200px; margin: auto; animation: fadeIn 0.5s ease; }
        .active-page { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* البطاقات */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: var(--white); padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-top: 5px solid var(--primary); }
        
        /* النماذج والجداول */
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        button { cursor: pointer; border: none; border-radius: 8px; transition: 0.3s; font-weight: bold; }
        .btn-main { background: var(--primary); color: white; width: 100%; padding: 15px; font-size: 16px; }
        .btn-main:hover { background: var(--secondary); }
        .btn-del { background: var(--danger); color: white; padding: 5px 10px; }

        table { width: 100%; border-collapse: collapse; background: white; border-radius: 10px; overflow: hidden; margin-top: 20px; }
        th, td { padding: 15px; border-bottom: 1px solid #eee; text-align: center; }
        th { background: #f8f9fa; color: var(--primary); }

        .stat-val { font-size: 28px; font-weight: bold; color: var(--primary); }

        /* شاشة الدخول */
        #login-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--primary); display: flex; justify-content: center;
            align-items: center; z-index: 9999;
        }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="card" style="width: 350px; text-align: center;">
            <i class="fas fa-kiwi-bird fa-3x" style="color: var(--primary);"></i>
            <h2>نظام إدارة الدواجن</h2>
            <input type="password" id="login-pass" placeholder="أدخل كلمة المرور">
            <button class="btn-main" onclick="checkLogin()">دخول للنظام</button>
            <p style="font-size: 12px; color: #777; margin-top: 10px;">تجربة: 123</p>
        </div>
    </div>

    <nav id="main-nav" style="display: none;">
        <div style="font-size: 20px; font-weight: bold;"><i class="fas fa-farm"></i> مزرعتي</div>
        <div class="nav-links">
            <span onclick="goTo('home')"><i class="fas fa-home"></i> الرئيسية</span>
            <span onclick="goTo('barns')"><i class="fas fa-warehouse"></i> العنابر</span>
            <span onclick="goTo('store')"><i class="fas fa-box"></i> المخزن</span>
            <span onclick="goTo('finance')"><i class="fas fa-dollar-sign"></i> المالية</span>
        </div>
        <button onclick="location.reload()" style="background:none; color:white;"><i class="fas fa-sign-out-alt"></i></button>
    </nav>

    <div id="home" class="page">
        <h2><i class="fas fa-chart-line"></i> حالة المزرعة الآن</h2>
        <div class="grid">
            <div class="card"><h3>إجمالي الدواجن</h3><div class="stat-val" id="sum-birds">0</div></div>
            <div class="card"><h3>إجمالي المصاريف</h3><div class="stat-val" id="sum-costs">0 د.ع</div></div>
            <div class="card"><h3>كمية العلف المتوفرة</h3><div class="stat-val" id="sum-feed">0 كجم</div></div>
        </div>
    </div>

    <div id="barns" class="page">
        <div class="card">
            <h3><i class="fas fa-plus-circle"></i> إضافة عنبر جديد</h3>
            <input type="text" id="b-name" placeholder="اسم العنبر (مثلاً: عنبر الشمال)">
            <input type="number" id="b-count" placeholder="عدد الطيور">
            <button class="btn-main" onclick="addBarn()">إضافة العنبر</button>
        </div>
        <table>
            <thead><tr><th>العنبر</th><th>العدد</th><th>إجراء</th></tr></thead>
            <tbody id="barns-table"></tbody>
        </table>
    </div>

    <div id="store" class="page">
        <div class="card">
            <h3><i class="fas fa-shovels"></i> إدارة المخزن (أعلاف/أدوية)</h3>
            <input type="text" id="s-item" placeholder="اسم المادة">
            <input type="number" id="s-qty" placeholder="الكمية">
            <button class="btn-main" onclick="addStore()">تحديث المخزن</button>
        </div>
        <table>
            <thead><tr><th>المادة</th><th>الكمية</th><th>إجراء</th></tr></thead>
            <tbody id="store-table"></tbody>
        </table>
    </div>

    <div id="finance" class="page">
        <div class="card">
            <h3><i class="fas fa-file-invoice-dollar"></i> تسجيل مصروفات</h3>
            <input type="text" id="f-desc" placeholder="بيان الصرف">
            <input type="number" id="f-amount" placeholder="المبلغ">
            <button class="btn-main" onclick="addFinance()">حفظ المصروف</button>
        </div>
        <table>
            <thead><tr><th>البيان</th><th>المبلغ</th><th>إجراء</th></tr></thead>
            <tbody id="finance-table"></tbody>
        </table>
    </div>

    <script>
        // تحميل البيانات من الذاكرة
        let db = JSON.parse(localStorage.getItem('poultrySystemDB')) || { barns: [], store: [], finance: [] };

        function checkLogin() {
            if(document.getElementById('login-pass').value === "123") {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('main-nav').style.display = 'flex';
                goTo('home');
                refreshAll();
            } else { alert("كلمة المرور خاطئة"); }
        }

        function goTo(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById(id).classList.add('active-page');
        }

        function addBarn() {
            const name = document.getElementById('b-name').value;
            const count = document.getElementById('b-count').value;
            if(name && count) {
                db.barns.push({id: Date.now(), name, count: parseInt(count)});
                save();
            }
        }

        function addStore() {
            const item = document.getElementById('s-item').value;
            const qty = document.getElementById('s-qty').value;
            if(item && qty) {
                db.store.push({id: Date.now(), item, qty: parseInt(qty)});
                save();
            }
        }

        function addFinance() {
            const desc = document.getElementById('f-desc').value;
            const amount = document.getElementById('f-amount').value;
            if(desc && amount) {
                db.finance.push({id: Date.now(), desc, amount: parseInt(amount)});
                save();
            }
        }

        function deleteRecord(type, id) {
            db[type] = db[type].filter(x => x.id !== id);
            save();
        }

        function save() {
            localStorage.setItem('poultrySystemDB', JSON.stringify(db));
            refreshAll();
            // تصفير المدخلات
            document.querySelectorAll('input').forEach(i => i.value = '');
        }

        function refreshAll() {
            // تحديث العنابر
            document.getElementById('barns-table').innerHTML = db.barns.map(b => 
                `<tr><td>${b.name}</td><td>${b.count}</td><td><button class="btn-del" onclick="deleteRecord('barns', ${b.id})">حذف</button></td></tr>`).join('');
            
            // تحديث المخزن
            document.getElementById('store-table').innerHTML = db.store.map(s => 
                `<tr><td>${s.item}</td><td>${s.qty}</td><td><button class="btn-del" onclick="deleteRecord('store', ${s.id})">حذف</button></td></tr>`).join('');
            
            // تحديث المالية
            document.getElementById('finance-table').innerHTML = db.finance.map(f => 
                `<tr><td>${f.desc}</td><td>${f.amount}</td><td><button class="btn-del" onclick="deleteRecord('finance', ${f.id})">حذف</button></td></tr>`).join('');

            // تحديث إحصائيات الرئيسية
            document.getElementById('sum-birds').innerText = db.barns.reduce((a,b) => a + b.count, 0);
            document.getElementById('sum-costs').innerText = db.finance.reduce((a,b) => a + b.amount, 0) + " د.ع";
            document.getElementById('sum-feed').innerText = db.store.reduce((a,b) => a + b.qty, 0) + " كجم";
        }
    </script>
</body>
</html>
